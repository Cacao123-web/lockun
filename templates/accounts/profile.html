{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container py-4">
  <h1 class="mb-4 text-center">Hồ sơ sức khỏe cá nhân</h1>

  <!-- Hiển thị thông báo -->
  {% if messages %}
    {% for m in messages %}
      <div class="alert {% if m.tags %}alert-{{ m.tags }}{% else %}alert-info{% endif %}">{{ m }}</div>
    {% endfor %}
  {% endif %}

  <!-- Chỉ số sức khỏe tổng quan -->
  <div class="row g-3 mb-4">
    <div class="col-md-3">
      <div class="border rounded p-3 text-center shadow-sm">
        <div class="small text-muted">BMI</div>
        <div class="fs-4 fw-bold text-primary">{{ profile.bmi|default:"—" }}</div>
        <div class="text-secondary">{{ profile.bmi_class|default:"" }}</div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="border rounded p-3 text-center shadow-sm">
        <div class="small text-muted">BMR</div>
        <div class="fs-4 fw-bold text-success">{{ profile.bmr|default:"—" }}</div>
        <div class="text-secondary">kcal/ngày</div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="border rounded p-3 text-center shadow-sm">
        <div class="small text-muted">TDEE</div>
        <div class="fs-4 fw-bold text-danger">{{ profile.tdee|default:"—" }}</div>
        <div class="text-secondary">kcal/ngày</div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="border rounded p-3 text-center shadow-sm">
        <div class="small text-muted">Tuổi</div>
        <div class="fs-4 fw-bold">{{ profile.age|default:"—" }}</div>
      </div>
    </div>
  </div>

  <!-- Form cập nhật -->
  <div class="card shadow-sm">
    <div class="card-header fw-bold">Cập nhật hồ sơ</div>
    <div class="card-body">
      <form method="post" novalidate>
        {% csrf_token %}
        {{ form.non_field_errors }}
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label">{{ form.full_name.label }}</label>
            {{ form.full_name }}
            <div class="text-danger small">{{ form.full_name.errors }}</div>
          </div>

          <div class="col-md-3">
            <label class="form-label">{{ form.age.label }}</label>
            {{ form.age }}
            <div class="text-danger small">{{ form.age.errors }}</div>
          </div>

          <div class="col-md-3">
            <label class="form-label">{{ form.gender.label }}</label>
            {{ form.gender }}
            <div class="text-danger small">{{ form.gender.errors }}</div>
          </div>

          <div class="col-md-3">
            <label class="form-label">{{ form.height_cm.label }}</label>
            {{ form.height_cm }}
            <div class="text-danger small">{{ form.height_cm.errors }}</div>
          </div>

          <div class="col-md-3">
            <label class="form-label">{{ form.weight_kg.label }}</label>
            {{ form.weight_kg }}
            <div class="text-danger small">{{ form.weight_kg.errors }}</div>
          </div>

          <div class="col-md-6">
            <label class="form-label">{{ form.activity_level.label }}</label>
            {{ form.activity_level }}
            <div class="text-danger small">{{ form.activity_level.errors }}</div>
          </div>
        </div>

        <button class="btn btn-success mt-4">
          <i class="bi bi-save"></i> Lưu hồ sơ
        </button>
      </form>
    </div>
  </div>
</div>
{% endblock %}
